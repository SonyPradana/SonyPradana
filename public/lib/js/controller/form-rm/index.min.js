const default_form_element={nomor_rm:$id("input-nomor-rm"),nama:$id("input-nama"),tanggal:$id("input-tgl-lahir"),alamat:$id("input-alamat"),rt:$id("input-nomor-rt"),rw:$id("input-nomor-rw"),mark_kk:$id("input-mark-as-kk"),nama_kk:$id("input-nama-kk"),nomor_kk:$id("input-nomor-rm-kk"),nomor_RmTerahir:$id("tambah-nomor-rm"),nomor_RmUpper:$id("tambah-nomor-rm-upper"),info_nomorRm:$query(".input-information.warning"),info_nomorRmKk:$query(".input-information.no-rm-kk"),info_Kk:$query(".input-information.kk-sama"),info_dusun:$query("p.dusun")},form_rm=function(n=default_form_element){const a=default_form_element;let r;n=Object.assign(a,n);let o={last_nomor_rm:0,last_id:0};function m(){const a=n.nomor_rm.value;0!=a.length&&a.length<7&&$json(`/api/ver1.0/RekamMedis/valid-nomor-rm.json?nr=${a}`).then((r=>{n.info_nomorRm.innerHTML="","ok"==r.status&&r.found>0&&(n.info_nomorRm.innerHTML=`<p>\n                  nomor rekam medis sama :\n                  <a href="/rekam-medis/search?nomor-rm-search=${a}" target="_blank" tabindex="12">lihat</a>\n                </p>`)}))}function e(){const a=n.nama.value,r=n.nama_kk.value,o=n.alamat.value,m=n.rt.value,e=n.rw.value;$json(`/api/ver1.0/RekamMedis/search-nomor-rm-kk.json?n=${r}&a=${o}&r=${m}&w=${e}`).then((t=>{n.info_nomorRmKk.innerHTML="",n.info_Kk.innerHTML="","ok"==t.status&&null!=t.nomor_rm_kk&&""!=t.nomor_rm_kk&&(n.info_nomorRmKk.innerHTML=`<p>\n                nomor rm kk :\n                <a href="javascript:void(0)" id="tambah-nomor-rm-kk" tabindex="12">\n                  ${t.nomor_rm_kk}\n                </a>\n              </p>`,$id("tambah-nomor-rm-kk").addEventListener("click",(()=>{n.nomor_rm_kk.value=t.nomor_rm_kk})),a==r&&(n.info_Kk.innerHTML=`<p>\n                  nama kk indentik :\n                  <a href="/rekam-medis/search?strict-search=on&alamat-search=${o}&no-rt-search=${m}&no-rw-search=${e}&nama-kk-search=${r}" target="_blank">\n                    lihat\n                  </a>\n                </p>`))}))}function t(a,o){let m="--";a in r&&(m=r[a][o]??"--"),n.info_dusun.innerText=m}function i(){$json("/api/ver1.1/Wilayah-Kab-Semarang/Data-Desa.json?kecamatan=ungaran-barat").then((a=>{"ok"==a.status&&(r=a.data,t(n.alamat.value,n.rw.value))})),$json("/api/ver1.1/RekamMedis/nomor-rm-terahir.json?limit=14000").then((a=>{"ok"==a.status&&(o=a.data,n.nomor_RmTerahir.innerText=o.last_nomor_rm)}))}return{refresh:()=>(i(),!0),init:()=>{i(),n.nomor_rm.addEventListener("input",(()=>{m()})),n.nama_kk.addEventListener("input",(()=>{e()})),n.alamat.addEventListener("input",(()=>{t(n.alamat.value,n.rw.value)})),n.rw.addEventListener("input",(()=>{t(n.alamat.value,n.rw.value)})),n.nomor_RmTerahir.addEventListener("click",(()=>{n.nomor_rm.value=o.last_nomor_rm+1,n.nomor_rm.focus(),m()})),n.nomor_RmUpper.addEventListener("click",(()=>{n.nomor_rm.value=o.upper_nomor_rm+1,n.nomor_rm.focus(),m()})),n.mark_kk.addEventListener("click",(a=>{1==a.target.checked?(n.nama_kk.value=n.nama.value,n.nomor_kk.value=n.nomor_rm.value):(n.nama_kk.value="",n.nomor_kk.value=""),e()}))},distroy:()=>{}}};
